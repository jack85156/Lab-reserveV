<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Make Reservation - Dr. V's Lab</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #ffffff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            border: 1px solid #e0e0e0;
        }
        
        header {
            background: #ffffff;
            color: #000000;
            padding: 40px;
            text-align: center;
            border-bottom: 2px solid #e0e0e0;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        nav {
            background: #f8f9fa;
            padding: 20px 40px;
            border-bottom: 2px solid #e9ecef;
        }
        
        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        
        nav a {
            text-decoration: none;
            color: #000000;
            font-weight: 600;
            padding: 12px 24px;
            border-radius: 4px;
            transition: all 0.3s;
            display: inline-block;
        }
        
        nav a:hover {
            background: #000000;
            color: white;
            transform: translateY(-1px);
        }
        
        main {
            padding: 40px;
        }
        
        .page-title {
            font-size: 2em;
            color: #000000;
            margin-bottom: 30px;
            text-align: center;
            font-weight: 700;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
            font-size: 1.1em;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1em;
            font-family: inherit;
            transition: all 0.3s;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #000000;
            box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
        }
        
        .form-group select option:disabled {
            color: #999;
            background: #f5f5f5;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .submit-btn {
            background: #000000;
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 4px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: all 0.3s;
        }
        
        .submit-btn:hover {
            background: #333333;
            transform: translateY(-1px);
        }
        
        .submit-btn:active {
            transform: translateY(0);
        }
        
        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #000000;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 25px;
        }
        
        .info-box p {
            color: #000000;
            line-height: 1.6;
        }
        
        footer {
            background: #f8f9fa;
            padding: 30px;
            text-align: center;
            color: #666;
            border-top: 2px solid #e9ecef;
        }
        
        /* Temperature Modal Styles */
        .temperature-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6);
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }
        
        .temperature-modal.show {
            display: flex;
            opacity: 1;
        }
        
        .temperature-modal-content {
            background-color: #ffffff;
            margin: auto;
            padding: 40px;
            border: 2px solid #000000;
            width: 90%;
            max-width: 500px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            text-align: center;
            transform: translateY(-20px);
            transition: transform 0.3s ease-in-out;
        }
        
        .temperature-modal.show .temperature-modal-content {
            transform: translateY(0);
        }
        
        .temperature-modal-content h3 {
            color: #000000;
            font-size: 1.8em;
            margin-bottom: 20px;
            font-weight: 700;
        }
        
        .temperature-modal-content p {
            color: #333;
            margin-bottom: 25px;
            font-size: 1.1em;
        }
        
        .temperature-modal-content select {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1.2em;
            font-family: inherit;
            margin-bottom: 25px;
        }
        
        .temperature-modal-content select:focus {
            outline: none;
            border-color: #000000;
            box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.1);
        }
        
        .temperature-modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }
        
        .temperature-modal-buttons button {
            padding: 12px 30px;
            border: none;
            border-radius: 4px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .temperature-modal-confirm {
            background: #000000;
            color: white;
        }
        
        .temperature-modal-confirm:hover {
            background: #333333;
        }
        
        .temperature-modal-cancel {
            background: #6c757d;
            color: white;
        }
        
        .temperature-modal-cancel:hover {
            background: #5a6268;
        }
        
        @media (max-width: 600px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <!-- Supabase Configuration -->
    <script src="supabase-config.js"></script>
    <!-- Supabase Client Library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/umd/supabase.min.js"></script>
    <!-- Storage abstraction (must come after Supabase) -->
    <script src="storage.js"></script>
    <script>
        // Check cloud database connection on page load
        window.addEventListener('DOMContentLoaded', async function() {
            const warningDiv = document.getElementById('dbWarning');
            if (!warningDiv) return;
            
            // Check if Supabase is configured
            const hasSupabase = window.SUPABASE_URL && window.SUPABASE_ANON_KEY;
            
            if (!hasSupabase) {
                // Supabase not configured, hide warning (local development)
                return;
            }
            
            // Test Supabase connection by checking if storage is using Supabase
            try {
                // Wait a bit for Supabase to initialize
                await new Promise(resolve => setTimeout(resolve, 500));
                
                // Try to get reservations (this will test the connection)
                const reservations = await Storage.getReservations();
                console.log('‚úÖ Cloud database (Supabase) connection verified');
            } catch (error) {
                // Supabase not working, show warning
                console.error('‚ùå Cloud database connection failed:', error);
                warningDiv.style.display = 'block';
            }
        });
    </script>
    <script>
        // Helper function to get today's date in Central Time Zone (US)
        function getCentralDateString() {
            const now = new Date();
            // Convert to Central Time using Intl.DateTimeFormat
            const formatter = new Intl.DateTimeFormat('en-US', {
                timeZone: 'America/Chicago',
                year: 'numeric',
                month: '2-digit',
                day: '2-digit'
            });
            const parts = formatter.formatToParts(now);
            const year = parts.find(part => part.type === 'year').value;
            const month = parts.find(part => part.type === 'month').value;
            const day = parts.find(part => part.type === 'day').value;
            return `${year}-${month}-${day}`;
        }
        
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const instrument = urlParams.get('instrument');
            if (instrument) {
                document.getElementById('instrument').value = instrument;
            }
            
            // Set minimum date to today in Central Time Zone
            const today = getCentralDateString();
            const dateInput = document.getElementById('date');
            dateInput.setAttribute('min', today);
            // Ensure the min attribute is properly set
            dateInput.min = today;
            
            // Populate modal temperature dropdown (30¬∞C to 100¬∞C)
            const modalTemperatureSelect = document.getElementById('modalTemperatureSelect');
            for (let i = 30; i <= 100; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = i + '¬∞C';
                modalTemperatureSelect.appendChild(option);
            }
            
            // Handle temperature modal when water bath is selected
            const instrumentSelect = document.getElementById('instrument');
            const temperatureField = document.getElementById('temperature');
            let pendingInstrumentSelection = null;
            
            window.showTemperatureModal = function(instrumentName) {
                const modal = document.getElementById('temperatureModal');
                const modalInstrumentName = document.getElementById('modalInstrumentName');
                modalInstrumentName.textContent = `Selected: ${instrumentName}`;
                modalTemperatureSelect.value = temperatureField.value ? temperatureField.value.replace('¬∞C', '') : ''; // Preselect if already chosen
                modal.classList.add('show');
                modalTemperatureSelect.focus();
            };
            
            function closeTemperatureModal() {
                const modal = document.getElementById('temperatureModal');
                modal.classList.remove('show');
            }
            
            window.confirmTemperature = function() {
                const selectedTemp = modalTemperatureSelect.value;
                if (!selectedTemp) {
                    alert('Please select a temperature (30¬∞C to 100¬∞C).');
                    modalTemperatureSelect.focus();
                    return;
                }
                
                // Store the selected temperature
                temperatureField.value = selectedTemp + '¬∞C';
                
                // Confirm the instrument selection
                if (pendingInstrumentSelection) {
                    instrumentSelect.value = pendingInstrumentSelection;
                    pendingInstrumentSelection = null;
                }
                
                closeTemperatureModal();
            };
            
            window.cancelTemperature = function() {
                // Clear the instrument selection if user cancels
                if (pendingInstrumentSelection) {
                    instrumentSelect.value = '';
                    temperatureField.value = '';
                    pendingInstrumentSelection = null;
                }
                closeTemperatureModal();
            };
            
            // Handle instrument selection change
            instrumentSelect.addEventListener('change', function() {
                const selectedInstrument = this.value;
                const isWaterBath = selectedInstrument === 'Chem-Grade Water Bath' || selectedInstrument === 'Food-Grade Water Bath';
                
                if (isWaterBath) {
                    // Always show modal when water bath is selected (allows changing temperature)
                    pendingInstrumentSelection = selectedInstrument;
                    window.showTemperatureModal(selectedInstrument);
                    // Temporarily clear the selection until temperature is confirmed
                    this.value = '';
                } else {
                    // Clear temperature for non-water bath instruments
                    temperatureField.value = '';
                }
            });
            
            // Close modal when clicking outside
            document.getElementById('temperatureModal').addEventListener('click', function(event) {
                if (event.target === this) {
                    cancelTemperature();
                }
            });
            
            // Close modal with Escape key, confirm with Enter key
            document.addEventListener('keydown', function(event) {
                const modal = document.getElementById('temperatureModal');
                if (modal.classList.contains('show')) {
                    if (event.key === 'Escape') {
                        cancelTemperature();
                    } else if (event.key === 'Enter' && document.activeElement === modalTemperatureSelect) {
                        event.preventDefault();
                        confirmTemperature();
                    }
                }
            });
            
            // Populate hour dropdowns (0-23)
            const startHourSelect = document.getElementById('startTimeHour');
            const endHourSelect = document.getElementById('endTimeHour');
            for (let i = 0; i < 24; i++) {
                const hour = String(i).padStart(2, '0');
                startHourSelect.innerHTML += `<option value="${hour}">${hour}</option>`;
                endHourSelect.innerHTML += `<option value="${hour}">${hour}</option>`;
            }
            
            // Function to update time options (no time limitations - only end time must be after start time)
            function updateTimeOptions() {
                const startHourSelect = document.getElementById('startTimeHour');
                const startMinuteSelect = document.getElementById('startTimeMinute');
                const endHourSelect = document.getElementById('endTimeHour');
                const endMinuteSelect = document.getElementById('endTimeMinute');
                
                // Enable all options first
                [startHourSelect, startMinuteSelect, endHourSelect, endMinuteSelect].forEach(select => {
                    Array.from(select.options).forEach(option => {
                        if (option.value !== '') {
                            option.disabled = false;
                            option.style.color = '';
                        }
                    });
                });
                
                // Only restriction: end time must be after start time
                const selectedStartTime = document.getElementById('startTime').value;
                if (selectedStartTime) {
                    const [startH, startM] = selectedStartTime.split(':').map(Number);
                    const selectedEndHour = parseInt(endHourSelect.value);
                    
                    // End time should be after start time
                    Array.from(endHourSelect.options).forEach(option => {
                        if (option.value !== '') {
                            const hour = parseInt(option.value);
                            // Disable hours before start hour
                            if (hour < startH) {
                                option.disabled = true;
                                option.style.color = '#999';
                            }
                        }
                    });
                    
                    // Update end minute options based on selected end hour
                    if (!isNaN(selectedEndHour)) {
                        Array.from(endMinuteSelect.options).forEach(minOption => {
                            if (minOption.value !== '') {
                                const minute = parseInt(minOption.value);
                                if (selectedEndHour < startH) {
                                    // End hour is before start hour (shouldn't happen, but disable anyway)
                                    minOption.disabled = true;
                                    minOption.style.color = '#999';
                                } else if (selectedEndHour === startH) {
                                    // Same hour as start, minutes must be after start minute
                                    if (minute <= startM) {
                                        minOption.disabled = true;
                                        minOption.style.color = '#999';
                                    }
                                }
                                // If end hour > start hour, all minutes are available
                            }
                        });
                    }
                }
            }
            
            // Update hidden time inputs when dropdowns change
            function updateTimeInput(hourSelect, minuteSelect, hiddenInput) {
                const hour = hourSelect.value;
                const minute = minuteSelect.value;
                if (hour && minute) {
                    hiddenInput.value = hour + ':' + minute;
                    updateTimeOptions(); // Update options when time changes
                    validateDateTime();
                } else {
                    hiddenInput.value = '';
                }
            }
            
            // Add event listeners for time dropdowns
            document.getElementById('startTimeHour').addEventListener('change', function() {
                updateTimeOptions(); // Update options when hour changes
                updateTimeInput(this, document.getElementById('startTimeMinute'), document.getElementById('startTime'));
            });
            document.getElementById('startTimeMinute').addEventListener('change', function() {
                updateTimeOptions(); // Update options when minute changes
                updateTimeInput(document.getElementById('startTimeHour'), this, document.getElementById('startTime'));
            });
            document.getElementById('endTimeHour').addEventListener('change', function() {
                updateTimeOptions(); // Update options when hour changes
                updateTimeInput(this, document.getElementById('endTimeMinute'), document.getElementById('endTime'));
            });
            document.getElementById('endTimeMinute').addEventListener('change', function() {
                updateTimeOptions(); // Update options when minute changes
                updateTimeInput(document.getElementById('endTimeHour'), this, document.getElementById('endTime'));
            });
            
            // Add validation listener for date
            document.getElementById('date').addEventListener('change', function() {
                const selectedDate = this.value;
                if (!selectedDate) return;
                
                // Get today's date in Central Time Zone
                const todayString = getCentralDateString();
                
                // Compare dates as strings (YYYY-MM-DD format)
                // Allow today and future dates, block only past dates
                if (selectedDate < todayString) {
                    alert('Cannot select a past date. Please select today or a future date.');
                    this.value = ''; // Clear the invalid date
                    return;
                }
                
                // Clear time selections when date changes to ensure fresh start
                document.getElementById('startTimeHour').value = '';
                document.getElementById('startTimeMinute').value = '';
                document.getElementById('endTimeHour').value = '';
                document.getElementById('endTimeMinute').value = '';
                document.getElementById('startTime').value = '';
                document.getElementById('endTime').value = '';
                updateTimeOptions(); // Update options immediately
                validateDateTime();
            });
            
            // Also validate on input event (when user types or uses date picker)
            document.getElementById('date').addEventListener('input', function() {
                const selectedDate = this.value;
                if (selectedDate) {
                    // Get today's date in Central Time Zone
                    const todayString = getCentralDateString();
                    
                    // Compare dates as strings (YYYY-MM-DD format)
                    // Allow today and future dates, block only past dates
                    if (selectedDate < todayString) {
                        this.setCustomValidity('Cannot select a past date. Please select today or a future date.');
                        this.reportValidity();
                    } else {
                        this.setCustomValidity('');
                    }
                }
                updateTimeOptions();
            });
            
            // Initial update of time options
            updateTimeOptions();
        };
        
        function isValid30MinInterval(time) {
            if (!time) return false;
            const [hours, minutes] = time.split(':').map(Number);
            return minutes === 0 || minutes === 30;
        }
        
        function validateDateTime() {
            const dateInput = document.getElementById('date');
            const startTimeInput = document.getElementById('startTime');
            const endTimeInput = document.getElementById('endTime');
            
            const selectedDate = dateInput.value;
            const startTime = startTimeInput.value;
            const endTime = endTimeInput.value;
            
            // Times are already validated to be 30-minute intervals by the dropdown
            
            if (!selectedDate || !startTime || !endTime) {
                return;
            }
            
            // Get today's date in Central Time Zone
            const todayString = getCentralDateString();
            
            // Check if date is in the past (compare as strings)
            // Allow today and future dates, block only past dates
            if (selectedDate < todayString) {
                dateInput.setCustomValidity('Cannot select a past date');
                dateInput.reportValidity();
                return;
            } else {
                dateInput.setCustomValidity('');
            }
            
            // No time limitations - clear any time validation
            startTimeInput.setCustomValidity('');
            if (endTimeInput) endTimeInput.setCustomValidity('');
            
            // Check if end time is after start time
            if (startTime && endTime) {
                const [startH, startM] = startTime.split(':').map(Number);
                const [endH, endM] = endTime.split(':').map(Number);
                
                if (endH < startH || (endH === startH && endM <= startM)) {
                    endTimeInput.setCustomValidity('End time must be after start time');
                    endTimeInput.reportValidity();
                    return;
                } else {
                    endTimeInput.setCustomValidity('');
                }
            }
        }
        
        async function handleSubmit(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            
            // Get form values
            const name = formData.get('name');
            const instrument = formData.get('instrument');
            const date = formData.get('date');
            const startTime = formData.get('startTime');
            const endTime = formData.get('endTime');
            
            // Validate required fields
            if (!name || !name.trim()) {
                alert('Please enter your name.');
                document.getElementById('name').focus();
                return;
            }
            
            if (!instrument || !date || !startTime || !endTime) {
                alert('Please fill in all required fields.');
                return;
            }
            
            const trimmedName = name.trim();
            
            // Get today's date in Central Time Zone
            const todayString = getCentralDateString();
            
            // Check if date is in the past (compare as strings)
            // Allow today and future dates, block only past dates
            if (date < todayString) {
                alert('Cannot make reservations for past dates. Please select today or a future date.');
                return;
            }
            
            // Validate 30-minute intervals
            if (!isValid30MinInterval(startTime)) {
                alert('Start time must be in 30-minute intervals (e.g., 6:00, 6:30, 7:00).');
                return;
            }
            
            if (!isValid30MinInterval(endTime)) {
                alert('End time must be in 30-minute intervals (e.g., 6:00, 6:30, 7:00).');
                return;
            }
            
            // Check if end time is after start time
            const [startH, startM] = startTime.split(':').map(Number);
            const [endH, endM] = endTime.split(':').map(Number);
            
            if (endH < startH || (endH === startH && endM <= startM)) {
                alert('End time must be after start time.');
                return;
            }
            
            // Validate temperature for water baths
            const selectedInstrument = instrument;
            const isWaterBath = selectedInstrument === 'Chem-Grade Water Bath' || selectedInstrument === 'Food-Grade Water Bath';
            const temperature = document.getElementById('temperature').value;
            
            if (isWaterBath && !temperature) {
                alert('Please select a temperature for the water bath (30¬∞C to 100¬∞C).');
                // Show the modal again if temperature not selected
                window.showTemperatureModal(selectedInstrument);
                return;
            }
            
            if (!instrument || !date || !startTime || !endTime) {
                alert('Please fill in all required fields.');
                return;
            }
            
            const reservation = {
                instrument: instrument,
                name: trimmedName, // Trim whitespace from name
                date: date,
                startTime: startTime,
                endTime: endTime
            };
            
            // Debug: Log reservation before saving
            console.log('Saving reservation:', reservation);
            
            // Add temperature if it's a water bath (already includes ¬∞C from modal)
            if (isWaterBath && temperature) {
                reservation.temperature = temperature;
            }
            
            // Add purpose if provided (optional field)
            const purpose = formData.get('purpose');
            if (purpose && purpose.trim()) {
                reservation.purpose = purpose.trim();
            }
            
            // Store reservation using Storage API (works with localStorage or backend)
            reservation.id = Date.now().toString();
            try {
                const savedReservation = await Storage.saveReservation(reservation);
                console.log('Reservation saved:', savedReservation);
                
                // Keep a copy for the details page
                localStorage.setItem('viewingReservation', JSON.stringify(savedReservation || reservation));
                
                alert('Reservation submitted successfully!');
                // Go to instruments page to see available instruments
                window.location.href = 'instruments.html';
            } catch (error) {
                alert('Error saving reservation. Please try again.');
                console.error('Error saving reservation:', error);
            }
        }
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ü•õ Dr. V's Lab</h1>
            <p>Instrument Reservation System</p>
        </header>
        
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="instruments.html">View Instruments</a></li>
                <li><a href="make-reservation.html">Make Reservation</a></li>
                <li><a href="view-reservations.html">My Reservations</a></li>
            </ul>
        </nav>
        
        <main>
            <h2 class="page-title">Make a Reservation</h2>
            
            <!-- Cloud Database Connection Warning -->
            <div id="dbWarning" style="display: none; background: #fff3cd; border: 2px solid #ffc107; border-radius: 8px; padding: 15px; margin-bottom: 20px; color: #856404;">
                <strong>‚ö†Ô∏è Warning: Cloud Database Not Connected</strong>
                <p style="margin: 10px 0 0 0; font-size: 0.9em;">
                    Your reservation will be saved locally only and won't be visible on other devices. 
                    Please check Vercel KV connection. See <a href="QUICK_FIX_VERCEL_KV.md" target="_blank" style="color: #856404; text-decoration: underline;">QUICK_FIX_VERCEL_KV.md</a> for help.
                </p>
            </div>
            
            <div class="info-box">
                <p><strong>Note:</strong> Please fill out all fields accurately. Reservations are subject to approval and availability.</p>
            </div>
            
            <form onsubmit="handleSubmit(event)">
                <div class="form-group">
                    <label for="instrument">Select Instrument *</label>
                    <select id="instrument" name="instrument" required>
                        <option value="">-- Select an instrument --</option>
                        <optgroup label="Particle Analysis">
                            <option value="Mastersizer">Mastersizer</option>
                            <option value="Zetasizer Ultra">Zetasizer Ultra</option>
                            <option value="Zetasizer Nano ZS">Zetasizer Nano ZS</option>
                        </optgroup>
                        <optgroup label="Particle Size Reduction">
                            <option value="Chem-Grade IKA Ultra-Turrax T25 Homogenizer">Chem-Grade IKA Ultra-Turrax T25 Homogenizer</option>
                            <option value="Chem-Grade SONICS Ultrasonic Extractor">Chem-Grade SONICS Ultrasonic Extractor</option>
                            <option value="Food-Grade IKA Ultra-Turrax T25 Homogenizer">Food-Grade IKA Ultra-Turrax T25 Homogenizer</option>
                            <option value="Food-Grade SONICS Ultrasonic Extractor">Food-Grade SONICS Ultrasonic Extractor</option>
                        </optgroup>
                        <optgroup label="Rheology">
                            <option value="Kinexus Rheometer">Kinexus Rheometer</option>
                            <option value="Anton Paar Rheometer">Anton Paar Rheometer</option>
                        </optgroup>
                        <optgroup label="Temperature Control">
                            <option value="Chem-Grade Water Bath">Chem-Grade Water Bath</option>
                            <option value="Food-Grade Water Bath">Food-Grade Water Bath</option>
                        </optgroup>
                        <optgroup label="Separation">
                            <option value="Food-Grade Benchtop Centrifuge">Food-Grade Benchtop Centrifuge</option>
                        </optgroup>
                        <optgroup label="Material Testing">
                            <option value="Texture Analyzer">Texture Analyzer</option>
                        </optgroup>
                        <optgroup label="Preservation">
                            <option value="Food-Grade Freeze Dryer">Food-Grade Freeze Dryer</option>
                        </optgroup>
                        <optgroup label="Extraction">
                            <option value="Velp Automatic Solvent Extractor">Velp Automatic Solvent Extractor</option>
                        </optgroup>
                    </select>
                </div>
                
                <input type="hidden" id="temperature" name="temperature">
                
                <div class="form-group">
                    <label for="name">Name: Enter your name *</label>
                    <input type="text" id="name" name="name" required placeholder="Enter your name">
                </div>
                
                <div class="form-group">
                    <label for="date">Reservation Date *</label>
                    <input type="date" id="date" name="date" required min="">
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Start Time *</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <select id="startTimeHour" required style="flex: 1; padding: 12px; border: 2px solid #e9ecef; border-radius: 4px; font-size: 1em;">
                                <option value="">Hour</option>
                            </select>
                            <span style="font-size: 1.2em; font-weight: bold;">:</span>
                            <select id="startTimeMinute" required style="flex: 1; padding: 12px; border: 2px solid #e9ecef; border-radius: 4px; font-size: 1em;">
                                <option value="">Minute</option>
                                <option value="00">00</option>
                                <option value="30">30</option>
                            </select>
                        </div>
                        <input type="hidden" id="startTime" name="startTime" required>
                    </div>
                    
                    <div class="form-group">
                        <label>End Time *</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <select id="endTimeHour" required style="flex: 1; padding: 12px; border: 2px solid #e9ecef; border-radius: 4px; font-size: 1em;">
                                <option value="">Hour</option>
                            </select>
                            <span style="font-size: 1.2em; font-weight: bold;">:</span>
                            <select id="endTimeMinute" required style="flex: 1; padding: 12px; border: 2px solid #e9ecef; border-radius: 4px; font-size: 1em;">
                                <option value="">Minute</option>
                                <option value="00">00</option>
                                <option value="30">30</option>
                            </select>
                        </div>
                        <input type="hidden" id="endTime" name="endTime" required>
                    </div>
                </div>
                
                <div class="form-group" style="margin-top: 20px; margin-bottom: 25px;">
                    <label for="purpose" style="display: block; margin-bottom: 8px; color: #000000; font-weight: 600; font-size: 1.1em;">Purpose (Optional)</label>
                    <textarea id="purpose" name="purpose" rows="4" placeholder="Leave a note about the purpose of this reservation..." style="width: 100%; padding: 12px; border: 2px solid #000000; border-radius: 8px; font-size: 1em; font-family: inherit; min-height: 100px; resize: vertical; display: block; box-sizing: border-box; background-color: #ffffff;"></textarea>
                    <small style="color: #666; font-size: 0.9em; display: block; margin-top: 5px;">This field is optional. You can leave it blank if you don't need to add a note.</small>
                </div>
                
                <button type="submit" class="submit-btn">Submit Reservation</button>
            </form>
        </main>
        
        <footer>
            <p>&copy; 2025 Dr. V's Lab. All rights reserved.</p>
        </footer>
    </div>
    
    <!-- Temperature Selection Modal -->
    <div id="temperatureModal" class="temperature-modal">
        <div class="temperature-modal-content">
            <h3>Temperature Selection Required</h3>
            <p id="modalInstrumentName"></p>
            <p>Please select the temperature you will use (30¬∞C to 100¬∞C):</p>
            <select id="modalTemperatureSelect">
                <option value="">-- Select temperature --</option>
            </select>
            <div class="temperature-modal-buttons">
                <button class="temperature-modal-confirm" onclick="confirmTemperature()">Confirm</button>
                <button class="temperature-modal-cancel" onclick="cancelTemperature()">Cancel</button>
            </div>
        </div>
    </div>
</body>
</html>


